<h1>Addresses</h1>
<% unless @user.has_maximum_addresses? %>
  <div class="pure-form">
    <%= form_for @address, url: {action: "create"} do |f| %>
      <fieldset>
        <legend>Add a new email address</legend>
        <%= f.text_field :to, :placeholder => "Address" %>
        <%= f.submit "Add", :class => "pure-button pure-button-primary" %>
      </fieldset>
    <% end %>
  </div>
<% else %>
  <div>__add an upgrade partial__</div>
<% end %>

<% unless @user.addresses.empty? %>
  # TODO: add a title here
  <div class="table">
    <table class="pure-table">
      <thead>
        <tr>
          <th>Address</th>
          <th>Aliases</th>
          <th>Actions</th>
        </tr>
      </thead>

      <% @user.addresses.each do |a| %>
        <tbody>
          <tr>
            <td class="<%= "not_verified" unless a.verified %> <%= "default" if a.to == @user.email %>">
              <%= a.to %>
            </td>
            <td>
              <%= a.aliases.count %>
            </td>
            <td>
              <%= button_to "Edit",   { :controller => "addresses", :action => "edit", :id => a.id }, :method => :get, :class => "pure-button" %>
              <% unless a.verified? %>
                <%= button_to "Verify", { :controller => "addresses", :action => "verify", :address_id => a.id}, :method => :post, :class => "pure-button" %>
              <% end %>
              <% if a.aliases.count.zero? %>
                <%= button_to "Delete", { :controller => "addresses", :action => "destroy", :id => a.id}, :data => { :confirm => "Are you sure?" }, :method => :delete, :class => "pure-button" %>
              <% end %>
              <% unless a.default? %>
                <%= button_to "Make Default", { :controller => "addresses", :action => "default", :address_id => a.id}, :method => :post, :class => "pure-button" %>
              <% end %>
            </td>
          </tr>
        </tbody>
      <% end %>
    </table>
  </div>
<% end %>

